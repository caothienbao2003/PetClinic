@page
@model PetClinic.Pages.Doctor.DoctorProfileModel
@{
    ViewData["Title"] = "Doctor Profile Page";

    var userId = HttpContext.Session.GetString("UserId");
    var role = HttpContext.Session.GetString("Role");

    if (userId == null || role != "2")
    {
        Response.Redirect("/Authentication/Login");
    }
}

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pet Clinic Homepage</title>
    <link rel="stylesheet" href="~/css/luongDoctorStyle.css" />
</head>

<div class="user-info">
    <span>Welcome, @Model.user.FirstName @Model.user.LastName!</span>
    <a asp-page="/Doctor/DoctorHomePage"><button>Back to Home</button></a>
</div>

<h1>Doctor Profile</h1>

<div class="row">
    <div class="profile-info">
        <h2>View Profile</h2>
        <div class="text-center">
            <img src="@(Model.user?.Image ?? "/img/default-profile.png")" alt="Profile Picture" style="width: 200px">
        </div>
        <dl class="row">
            <dt class="col-sm-3">First Name</dt>
            <dd class="col-sm-9">@Model.user.FirstName</dd>
            <dt class="col-sm-3">Last Name</dt>
            <dd class="col-sm-9">@Model.user.LastName</dd>
            <dt class="col-sm-3">Email</dt>
            <dd class="col-sm-9">@Model.user.Email</dd>
            <dt class="col-sm-3">Address</dt>
            <dd class="col-sm-9">@Model.user.Address</dd>
            <dt class="col-sm-3">Gender</dt>
            <dd class="col-sm-9">@Model.user.Gender</dd>
        </dl>
        <button class="btn btn-primary" id="editProfileBtn">Edit Profile</button>
    </div>
    <div class="profile-info" id="editProfileForm" style="display: none;">
        <h2>Edit Profile</h2>
        <form method="post" enctype="multipart/form-data">
            <div class="form-group">
                <label asp-for="updateImage" class="control-label">Profile Picture</label>
                <input asp-for="updateImage" class="form-control" type="file" id="updateImage" name="updateImage" />
                <span asp-validation-for="updateImage" class="text-danger"></span>
            </div>
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <input type="hidden" asp-for="user.UserId" />
            <div class="form-group">
                <label asp-for="user.FirstName" class="control-label">First Name</label>
                <input asp-for="user.FirstName" class="form-control" />
                <span asp-validation-for="user.FirstName" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="user.LastName" class="control-label">Last Name</label>
                <input asp-for="user.LastName" class="form-control" />
                <span asp-validation-for="user.LastName" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="user.SocialNumber" class="control-label">Social Number</label>
                <input asp-for="user.SocialNumber" class="form-control" />
                <span asp-validation-for="user.SocialNumber" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="user.Password" class="control-label">Password</label>
                <input type="password" asp-for="user.Password" class="form-control" />
                <span asp-validation-for="user.Password" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="user.PhoneNumber" class="control-label">Phone Number</label>
                <input asp-for="user.PhoneNumber" class="form-control" />
                <span asp-validation-for="user.PhoneNumber" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="user.Address" class="control-label">Address</label>
                <input asp-for="user.Address" class="form-control" />
                <span asp-validation-for="user.Address" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="user.Email" class="control-label">Email</label>
                <input asp-for="user.Email" class="form-control" />
                <span asp-validation-for="user.Email" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="user.Gender" class="control-label">Gender</label>
                <select asp-for="user.Gender" class="form-control">
                    <option value="">Select Gender</option>
                    <option value="Male">Male</option>
                    <option value="Female">Female</option>
                    <option value="Other">Other</option>
                </select>
                <span asp-validation-for="user.Gender" class="text-danger"></span>
            </div>
            <div class="form-group">
                <input type="hidden" asp-for="user.DoctorRank" />
            </div>
            <div class="form-group">
                <input type="hidden" asp-for="user.DoctorCapacity" />
            </div>
            <div class="form-group">
                <input type="hidden" asp-for="user.EmployeeSalary" />
            </div>
            <div class="form-group">
                <input type="hidden" asp-for="user.Role" />
            </div>
            <div class="form-group">
                <input type="hidden" asp-for="user.ActiveStatus" />
            </div>
            <div class="form-group">
                <input type="submit" value="Save" class="btn btn-primary" />
            </div>
        </form>
    </div>
</div>

<script>
    document.getElementById('editProfileBtn').addEventListener('click', function () {
        var editProfileForm = document.getElementById('editProfileForm');
        editProfileForm.style.display = 'block';
        this.style.display = 'none';
    });
</script>