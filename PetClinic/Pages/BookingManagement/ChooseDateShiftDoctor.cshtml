@page
@model PetClinic.Pages.BookingManagement.ChooseDateShiftDoctorModel
@{
    ViewData["Title"] = "Choose Date, Shift, and Doctor";
}

<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />
<link href="~/css/chooseDateShiftDoctor.css" rel="stylesheet" />

<div class="booking-container">
    <div class="calendar-container">
        <h1 class="booking-header">Booking</h1>

        <div class="navigation-buttons">
            <i class="fas fa-arrow-left" id="prevMonthBtn" onclick="changeMonth(-1)"></i>
            <div class="month-year-wrapper">
                <span id="monthYearDisplay">@Model.CurrentDateOnCalendar.ToString("MMMM yyyy")</span>
            </div>
            <i class="fas fa-arrow-right" id="nextMonthBtn" onclick="changeMonth(1)"></i>
        </div>

        <table class="calendar">
            <thead>
                <tr>
                    <th>Su</th>
                    <th>Mo</th>
                    <th>Tu</th>
                    <th>We</th>
                    <th>Th</th>
                    <th>Fr</th>
                    <th>Sa</th>
                </tr>
            </thead>
            <tbody id="calendarBody">
                @await Html.PartialAsync("BookingCalendarLayout", Model)
            </tbody>
        </table>

        <div class="form-group text-center">
            <a asp-page="ChoosePet" class="back-link"><i class="fas fa-arrow-left"></i> Back to Choose Pet</a>
        </div>
    </div>

    <div class="details-container">
        <h2>Available slots</h2>
        <div class="slots-container">
            @foreach (var shift in Model.ShiftList)
            {
                <div class="slot" onclick="selectSlot(this, @shift.ShiftId)">
                    @string.Format("{0:hh\\:mm}", shift.StartTime) - @string.Format("{0:hh\\:mm}", shift.EndTime)
                </div>
            }
        </div>

        <h2>Available Doctors</h2>
        <div class="doctors-container">
            @foreach (var doctor in Model.DoctorList)
            {
                <div class="doctor" onclick="selectDoctor(this, @doctor.UserId)">
                    @doctor.FirstName @doctor.LastName
                </div>
            }
        </div>

        <div class="form-group text-center">
            <form method="post">
                <input type="hidden" asp-for="SelectedShiftId" id="SelectedShift" />
                <input type="hidden" asp-for="SelectedDoctorId" id="SelectedDoctor" />
                <input type="hidden" asp-for="SelectedPetId" value="@Model.SelectedPetId" />
                <input type="submit" value="Next" class="btn btn-primary" />
            </form>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="~/js/chooseDateShiftDoctor.js"></script>

<script>
    var selectedPetId = @Html.Raw(Json.Serialize(Model.SelectedPetId));
</script>